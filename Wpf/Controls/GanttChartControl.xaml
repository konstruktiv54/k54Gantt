<!-- GanttChart.WPF/Controls/GanttChartControl.xaml -->
<UserControl x:Class="Wpf.Controls.GanttChartControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="400" 
             d:DesignWidth="800"
             Background="{StaticResource BackgroundBrush}"
             ClipToBounds="True">

    <Grid>
        <Grid.RowDefinitions>
            <!-- Заголовок (месяцы + дни) - фиксированный -->
            <RowDefinition Height="Auto"/>
            <!-- Область с задачами - скроллируемая -->
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- HEADER (фиксированный)                                          -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <Border Grid.Row="0" 
                Background="{StaticResource HeaderBackgroundBrush}"
                BorderBrush="{StaticResource GridLineBrush}"
                BorderThickness="0,0,0,1">
            
            <!-- Контейнер для горизонтального скролла заголовка -->
            <ScrollViewer x:Name="HeaderScrollViewer"
                          HorizontalScrollBarVisibility="Hidden"
                          VerticalScrollBarVisibility="Disabled"
                          CanContentScroll="True">
                <Canvas x:Name="HeaderCanvas" 
                        Height="50"
                        ClipToBounds="True"/>
            </ScrollViewer>
        </Border>

        <!-- ═══════════════════════════════════════════════════════════════ -->
        <!-- MAIN CHART AREA (скроллируемая)                                 -->
        <!-- ═══════════════════════════════════════════════════════════════ -->
        <ScrollViewer x:Name="ChartScrollViewer"
                      Grid.Row="1"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      CanContentScroll="True"
                      ScrollChanged="OnChartScrollChanged">
            
            <!-- Основной Canvas со слоями -->
            <Canvas x:Name="ChartCanvas" ClipToBounds="True">
                
                <!-- Слой 1: Сетка и выходные дни (самый нижний) -->
                <Canvas x:Name="GridLayer" Panel.ZIndex="0"/>
                
                <!-- Слой 2: Линия "Сегодня" -->
                <Canvas x:Name="TodayLayer" Panel.ZIndex="1"/>
                
                <!-- Слой 3: Бары задач -->
                <Canvas x:Name="TaskLayer" Panel.ZIndex="2"/>
                
                <!-- Слой 4: Линии связей -->
                <Canvas x:Name="RelationLayer" Panel.ZIndex="3"/>
                
                <!-- Слой 5: Overlay (выделение, drag preview) -->
                <Canvas x:Name="OverlayLayer" Panel.ZIndex="4"/>
                
            </Canvas>
        </ScrollViewer>
    </Grid>
</UserControl>